{
  "tasks": {
    "[Init] Start/restart Api2 server": {
      "schedule": "*/15 * * * *",
      "run_on_load": true,
      "bash_script": [
        "[ ! -d 'repo' ] && git clone  --depth 1 https://github.com/DefiLlama/defillama-server repo",
        "[ ! -d 'runner' ] && git clone  --depth 1 https://github.com/DefiLlama/task-runner runner",
        "cd runner",
        "git pull",
        "cd ../repo/defi",
        "git stash",
        "git pull",
        "git submodule update --init --recursive",
        "git submodule update --remote --merge",
        "cd DefiLlama-Adapters",
        "git checkout main",
        "git pull",
        "cd ..",
        "npm i",
        "npm update @defillama/sdk",
        "cd DefiLlama-Adapters",
        "git checkout main",
        "git pull",
        "cd ..",
        "# set up dummy imports",
        "echo 'export default {}' > $ROOT_DIR/src/utils/imports/adapters.ts",
        "SKIP_CAHE_WRITE_R2=true npm run cache-config",
        "npm run api2-cron-task",
        "# start/rolling restart api2 server",
        "npx pm2 start src/api2/ecosystem.config.js || npx pm2 reload",
        "npx pm2 status all",
        "npx pm2 logs"
      ]
    },
    "[Init] Update Raises data": {
      "schedule": "42 */2 * * *",
      "run_on_load": true,
      "bash_script": [
        "cd ../repo/defi",
        "npx ts-node src/api2/cron-task/raises.ts"
      ]
    },
    "[Logs]": {
      "schedule": "*/15 * * * *",
      "run_on_load": true,
      "no_schedule": true,
      "bash_script": [
        "cd ../repo/defi",
        "npx pm2 logs"
      ]
    }
  }
}